@page "/api/points/balance"
@using BiketaBai.Helpers
@using BiketaBai.Services
@inject PointsService PointsService
@{
    Layout = null;
    
    var userId = AuthHelper.GetCurrentUserId(User);
    if (userId.HasValue)
    {
        var points = await PointsService.GetPointsBalanceAsync(userId.Value);
        
        Response.ContentType = "application/json";
        await Response.WriteAsync(System.Text.Json.JsonSerializer.Serialize(new { points }));
    }
    else
    {
        Response.StatusCode = 401;
        Response.ContentType = "application/json";
        await Response.WriteAsync(System.Text.Json.JsonSerializer.Serialize(new { error = "Unauthorized" }));
    }
}

