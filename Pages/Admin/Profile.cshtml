@page
@model BiketaBai.Pages.Admin.ProfileModel
@{
    ViewData["Title"] = "Admin Profile";
}

<div class="container my-5">
    <!-- Header -->
    <div class="dashboard-header mb-4">
        <div class="row align-items-center">
            <div class="col-md-8">
                <h2 class="text-eco-green mb-2">
                    <i class="bi bi-shield-lock"></i> Administrator Profile
                </h2>
                <p class="text-muted mb-0">Manage your admin account and view system information</p>
            </div>
            <div class="col-md-4 text-md-end">
                <a href="/Dashboard/Admin" class="btn btn-outline-secondary">
                    <i class="bi bi-arrow-left"></i> Back to Dashboard
                </a>
            </div>
        </div>
    </div>

    <!-- Success/Error Messages -->
    @if (!string.IsNullOrEmpty(Model.SuccessMessage))
    {
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="bi bi-check-circle"></i> @Model.SuccessMessage
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    @if (!string.IsNullOrEmpty(Model.ErrorMessage))
    {
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            <i class="bi bi-exclamation-triangle"></i> @Model.ErrorMessage
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    <!-- Admin Profile Card -->
    <div class="card shadow-sm border-0 mb-4">
        <div class="card-body">
            <div class="row align-items-center">
                <div class="col-md-3 text-center">
                    <div class="admin-avatar-large">
                        <i class="bi bi-shield-fill"></i>
                    </div>
                    <h4 class="mt-3 mb-1">@Model.CurrentAdmin.FullName</h4>
                    <p class="text-muted mb-2">@Model.CurrentAdmin.Email</p>
                    
                    <!-- Admin Badge -->
                    <div class="mb-3">
                        <span class="badge bg-danger px-3 py-2" style="font-size: 0.95rem;">
                            <i class="bi bi-shield-fill"></i> System Administrator
                        </span>
                    </div>
                    
                    <!-- Access Level -->
                    <div class="admin-access-badge">
                        <i class="bi bi-unlock-fill"></i>
                        <div>
                            <small class="text-muted d-block">Access Level</small>
                            <strong>Full Control</strong>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-9">
                    <!-- System Overview Stats -->
                    <div class="row mb-4">
                        <div class="col-md-3 mb-3">
                            <div class="admin-stat-mini bg-primary">
                                <i class="bi bi-people"></i>
                                <div>
                                    <h4>@Model.TotalSystemUsers</h4>
                                    <small>System Users</small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-3 mb-3">
                            <div class="admin-stat-mini bg-success">
                                <i class="bi bi-bicycle"></i>
                                <div>
                                    <h4>@Model.TotalSystemBikes</h4>
                                    <small>Bike Listings</small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-3 mb-3">
                            <div class="admin-stat-mini bg-info">
                                <i class="bi bi-calendar-check"></i>
                                <div>
                                    <h4>@Model.TotalSystemBookings</h4>
                                    <small>Total Bookings</small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-3 mb-3">
                            <div class="admin-stat-mini bg-warning">
                                <i class="bi bi-exclamation-triangle"></i>
                                <div>
                                    <h4>@Model.PendingVerifications</h4>
                                    <small>Pending Reviews</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Admin Info Table -->
                    <div class="card bg-light">
                        <div class="card-body">
                            <h6 class="text-muted mb-3"><i class="bi bi-info-circle"></i> Administrator Information</h6>
                            <table class="table table-borderless table-sm mb-0">
                                <tr>
                                    <td class="text-muted" width="40%"><i class="bi bi-person-badge"></i> Admin ID</td>
                                    <td><strong>#@Model.CurrentAdmin.UserId</strong></td>
                                </tr>
                                <tr>
                                    <td class="text-muted"><i class="bi bi-shield-check"></i> Access Level</td>
                                    <td><span class="badge bg-danger">Full Administrator</span></td>
                                </tr>
                                <tr>
                                    <td class="text-muted"><i class="bi bi-calendar-plus"></i> Account Created</td>
                                    <td>@Model.CurrentAdmin.CreatedAt.ToString("MMMM dd, yyyy 'at' h:mm tt")</td>
                                </tr>
                                <tr>
                                    <td class="text-muted"><i class="bi bi-clock-history"></i> Last Login</td>
                                    <td>@Model.LastLoginTime.ToString("MMMM dd, yyyy 'at' h:mm tt")</td>
                                </tr>
                                <tr>
                                    <td class="text-muted"><i class="bi bi-envelope-check"></i> Email Status</td>
                                    <td>
                                        @if (Model.CurrentAdmin.IsEmailVerified)
                                        {
                                            <span class="badge bg-success"><i class="bi bi-check-circle"></i> Verified</span>
                                        }
                                        else
                                        {
                                            <span class="badge bg-warning"><i class="bi bi-exclamation-circle"></i> Unverified</span>
                                        }
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Two Column Layout -->
    <div class="row">
        <!-- Edit Profile & Settings -->
        <div class="col-lg-6 mb-4">
            <!-- Edit Profile Form -->
            <div class="card shadow-sm border-0 mb-4">
                <div class="card-header bg-white border-bottom">
                    <h5 class="mb-0"><i class="bi bi-pencil-square text-success"></i> Edit Profile</h5>
                </div>
                <div class="card-body">
                    <form method="post">
                        <div class="mb-3">
                            <label asp-for="Input.FullName" class="form-label">
                                <i class="bi bi-person"></i> Full Name
                            </label>
                            <input asp-for="Input.FullName" class="form-control" required />
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">
                                <i class="bi bi-envelope"></i> Email Address
                            </label>
                            <input type="email" class="form-control" value="@Model.CurrentAdmin.Email" disabled />
                            <small class="text-muted">Email cannot be changed for admin accounts</small>
                        </div>
                        
                        <div class="mb-3">
                            <label asp-for="Input.Phone" class="form-label">
                                <i class="bi bi-telephone"></i> Phone Number
                            </label>
                            <input asp-for="Input.Phone" class="form-control" required />
                        </div>
                        
                        <div class="mb-3">
                            <label asp-for="Input.Address" class="form-label">
                                <i class="bi bi-geo-alt"></i> Address
                            </label>
                            <textarea asp-for="Input.Address" class="form-control" rows="3" required></textarea>
                        </div>
                        
                        <button type="submit" class="btn btn-success w-100">
                            <i class="bi bi-check-circle"></i> Update Profile
                        </button>
                    </form>
                </div>
            </div>

            <!-- Quick Settings -->
            <div class="card shadow-sm border-0">
                <div class="card-header bg-white border-bottom">
                    <h5 class="mb-0"><i class="bi bi-gear text-secondary"></i> Quick Settings</h5>
                </div>
                <div class="card-body">
                    <div class="list-group list-group-flush">
                        <a href="/Account/ChangePassword" class="list-group-item list-group-item-action">
                            <i class="bi bi-key text-warning"></i>
                            <strong class="ms-2">Change Password</strong>
                            <i class="bi bi-chevron-right float-end"></i>
                        </a>
                        <a href="/Admin/SystemSettings" class="list-group-item list-group-item-action">
                            <i class="bi bi-sliders text-primary"></i>
                            <strong class="ms-2">System Settings</strong>
                            <i class="bi bi-chevron-right float-end"></i>
                        </a>
                        <a href="/Admin/EmailSettings" class="list-group-item list-group-item-action">
                            <i class="bi bi-envelope-gear text-info"></i>
                            <strong class="ms-2">Email Configuration</strong>
                            <i class="bi bi-chevron-right float-end"></i>
                        </a>
                        <a href="/Admin/BackupRestore" class="list-group-item list-group-item-action">
                            <i class="bi bi-database text-success"></i>
                            <strong class="ms-2">Backup & Restore</strong>
                            <i class="bi bi-chevron-right float-end"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Activity & System Info -->
        <div class="col-lg-6 mb-4">
            <!-- Admin Activity -->
            <div class="card shadow-sm border-0 mb-4">
                <div class="card-header bg-white border-bottom">
                    <h5 class="mb-0"><i class="bi bi-activity text-danger"></i> Admin Activity</h5>
                </div>
                <div class="card-body">
                    <div class="activity-summary">
                        <div class="activity-item">
                            <div class="activity-icon bg-primary">
                                <i class="bi bi-calendar-day"></i>
                            </div>
                            <div class="activity-details">
                                <h4>@Model.TotalActionsToday</h4>
                                <p class="text-muted mb-0">Actions Today</p>
                            </div>
                        </div>
                        
                        <div class="activity-item">
                            <div class="activity-icon bg-success">
                                <i class="bi bi-calendar-week"></i>
                            </div>
                            <div class="activity-details">
                                <h4>@Model.TotalActionsThisWeek</h4>
                                <p class="text-muted mb-0">Actions This Week</p>
                            </div>
                        </div>
                        
                        <div class="activity-item">
                            <div class="activity-icon bg-info">
                                <i class="bi bi-calendar-month"></i>
                            </div>
                            <div class="activity-details">
                                <h4>@Model.TotalActionsThisMonth</h4>
                                <p class="text-muted mb-0">Actions This Month</p>
                            </div>
                        </div>
                    </div>
                    
                    <hr />
                    
                    <div class="text-center">
                        <a href="/Admin/AuditLog" class="btn btn-outline-primary">
                            <i class="bi bi-journal-text"></i> View Full Activity Log
                        </a>
                    </div>
                </div>
            </div>

            <!-- System Health -->
            <div class="card shadow-sm border-0">
                <div class="card-header bg-white border-bottom">
                    <h5 class="mb-0"><i class="bi bi-heart-pulse text-danger"></i> System Health</h5>
                </div>
                <div class="card-body">
                    <div class="system-health-item">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span><i class="bi bi-hdd"></i> Database Status</span>
                            <span class="badge bg-success">Healthy</span>
                        </div>
                        <div class="progress" style="height: 6px;">
                            <div class="progress-bar bg-success" style="width: 100%"></div>
                        </div>
                    </div>
                    
                    <div class="system-health-item mt-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span><i class="bi bi-server"></i> Server Status</span>
                            <span class="badge bg-success">Running</span>
                        </div>
                        <div class="progress" style="height: 6px;">
                            <div class="progress-bar bg-success" style="width: 100%"></div>
                        </div>
                    </div>
                    
                    <div class="system-health-item mt-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span><i class="bi bi-envelope"></i> Email Service</span>
                            <span class="badge bg-success">Active</span>
                        </div>
                        <div class="progress" style="height: 6px;">
                            <div class="progress-bar bg-success" style="width: 100%"></div>
                        </div>
                    </div>
                    
                    <div class="system-health-item mt-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span><i class="bi bi-shield-check"></i> Security</span>
                            <span class="badge bg-success">Protected</span>
                        </div>
                        <div class="progress" style="height: 6px;">
                            <div class="progress-bar bg-success" style="width: 100%"></div>
                        </div>
                    </div>
                    
                    <hr class="my-3" />
                    
                    <div class="alert alert-info mb-0">
                        <small>
                            <i class="bi bi-info-circle"></i>
                            <strong>System Version:</strong> Bike Ta Bai v3.0<br />
                            <strong>Last Updated:</strong> @DateTime.UtcNow.ToString("MMMM dd, yyyy")
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Platform Statistics -->
    <div class="card shadow-sm border-0">
        <div class="card-header bg-white border-bottom">
            <h5 class="mb-0"><i class="bi bi-graph-up text-success"></i> Platform Overview</h5>
        </div>
        <div class="card-body">
            <div class="row text-center">
                <div class="col-md-3">
                    <div class="platform-stat">
                        <i class="bi bi-people text-primary"></i>
                        <h3>@Model.TotalSystemUsers</h3>
                        <p class="text-muted">Registered Users</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="platform-stat">
                        <i class="bi bi-bicycle text-success"></i>
                        <h3>@Model.TotalSystemBikes</h3>
                        <p class="text-muted">Total Bikes</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="platform-stat">
                        <i class="bi bi-calendar-check text-info"></i>
                        <h3>@Model.TotalSystemBookings</h3>
                        <p class="text-muted">Total Bookings</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="platform-stat">
                        <i class="bi bi-hourglass-split text-warning"></i>
                        <h3>@Model.PendingVerifications</h3>
                        <p class="text-muted">Pending Actions</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Auto-dismiss alerts
        window.setTimeout(function() {
            $(".alert").fadeTo(500, 0).slideUp(500, function(){
                $(this).remove(); 
            });
        }, 5000);
    </script>
}

